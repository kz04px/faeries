#![feature(test)]

extern crate test;

use games::{droptaxx::DroptaxxPosition, gamerules::GameRules};

fn run_perft() {
    let fens: [&str; 49] = [
        "7/7/7/7/7/7/x6 o 1",
        "7/7/7/7/7/7/1x5 o 1",
        "7/7/7/7/7/7/2x4 o 1",
        "7/7/7/7/7/7/3x3 o 1",
        "7/7/7/7/7/7/4x2 o 1",
        "7/7/7/7/7/7/5x1 o 1",
        "7/7/7/7/7/7/6x o 1",
        "7/7/7/7/7/x6/7 o 1",
        "7/7/7/7/7/1x5/7 o 1",
        "7/7/7/7/7/2x4/7 o 1",
        "7/7/7/7/7/3x3/7 o 1",
        "7/7/7/7/7/4x2/7 o 1",
        "7/7/7/7/7/5x1/7 o 1",
        "7/7/7/7/7/6x/7 o 1",
        "7/7/7/7/x6/7/7 o 1",
        "7/7/7/7/1x5/7/7 o 1",
        "7/7/7/7/2x4/7/7 o 1",
        "7/7/7/7/3x3/7/7 o 1",
        "7/7/7/7/4x2/7/7 o 1",
        "7/7/7/7/5x1/7/7 o 1",
        "7/7/7/7/6x/7/7 o 1",
        "7/7/7/x6/7/7/7 o 1",
        "7/7/7/1x5/7/7/7 o 1",
        "7/7/7/2x4/7/7/7 o 1",
        "7/7/7/3x3/7/7/7 o 1",
        "7/7/7/4x2/7/7/7 o 1",
        "7/7/7/5x1/7/7/7 o 1",
        "7/7/7/6x/7/7/7 o 1",
        "7/7/x6/7/7/7/7 o 1",
        "7/7/1x5/7/7/7/7 o 1",
        "7/7/2x4/7/7/7/7 o 1",
        "7/7/3x3/7/7/7/7 o 1",
        "7/7/4x2/7/7/7/7 o 1",
        "7/7/5x1/7/7/7/7 o 1",
        "7/7/6x/7/7/7/7 o 1",
        "7/x6/7/7/7/7/7 o 1",
        "7/1x5/7/7/7/7/7 o 1",
        "7/2x4/7/7/7/7/7 o 1",
        "7/3x3/7/7/7/7/7 o 1",
        "7/4x2/7/7/7/7/7 o 1",
        "7/5x1/7/7/7/7/7 o 1",
        "7/6x/7/7/7/7/7 o 1",
        "x6/7/7/7/7/7/7 o 1",
        "1x5/7/7/7/7/7/7 o 1",
        "2x4/7/7/7/7/7/7 o 1",
        "3x3/7/7/7/7/7/7 o 1",
        "4x2/7/7/7/7/7/7 o 1",
        "5x1/7/7/7/7/7/7 o 1",
        "6x/7/7/7/7/7/7 o 1",
    ];

    for fen in fens {
        let mut pos = DroptaxxPosition::from_fen(fen);
        std::hint::black_box(pos.perft(4));
    }
}

#[cfg(test)]
mod droptaxx {
    use super::*;
    use test::Bencher;

    #[bench]
    fn perft(b: &mut Bencher) {
        b.iter(|| run_perft());
    }
}
