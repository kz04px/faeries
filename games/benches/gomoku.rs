#![feature(test)]

extern crate test;

use games::{gamerules::GameRules, gomoku::GomokuPosition};

fn run_perft() {
    let fens: [&str; 225] = [
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/x14 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/1x13 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/2x12 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/3x11 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/4x10 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/5x9 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/6x8 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/7x7 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/8x6 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/9x5 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/10x4 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/11x3 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/12x2 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/13x1 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/15/14x o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/x14/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/1x13/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/2x12/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/3x11/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/4x10/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/5x9/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/6x8/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/7x7/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/8x6/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/9x5/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/10x4/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/11x3/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/12x2/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/13x1/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/15/14x/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/x14/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/1x13/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/2x12/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/3x11/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/4x10/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/5x9/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/6x8/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/7x7/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/8x6/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/9x5/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/10x4/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/11x3/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/12x2/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/13x1/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/15/14x/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/x14/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/1x13/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/2x12/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/3x11/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/4x10/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/5x9/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/6x8/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/7x7/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/8x6/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/9x5/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/10x4/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/11x3/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/12x2/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/13x1/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/15/14x/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/x14/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/1x13/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/2x12/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/3x11/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/4x10/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/5x9/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/6x8/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/7x7/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/8x6/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/9x5/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/10x4/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/11x3/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/12x2/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/13x1/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/15/14x/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/x14/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/1x13/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/2x12/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/3x11/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/4x10/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/5x9/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/6x8/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/7x7/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/8x6/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/9x5/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/10x4/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/11x3/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/12x2/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/13x1/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/15/14x/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/x14/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/1x13/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/2x12/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/3x11/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/4x10/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/5x9/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/6x8/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/7x7/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/8x6/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/9x5/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/10x4/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/11x3/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/12x2/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/13x1/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/15/14x/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/x14/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/1x13/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/2x12/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/3x11/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/4x10/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/5x9/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/6x8/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/7x7/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/8x6/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/9x5/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/10x4/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/11x3/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/12x2/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/13x1/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/15/14x/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/x14/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/1x13/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/2x12/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/3x11/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/4x10/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/5x9/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/6x8/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/7x7/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/8x6/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/9x5/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/10x4/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/11x3/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/12x2/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/13x1/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/15/14x/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/x14/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/1x13/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/2x12/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/3x11/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/4x10/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/5x9/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/6x8/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/7x7/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/8x6/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/9x5/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/10x4/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/11x3/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/12x2/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/13x1/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/15/14x/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/x14/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/1x13/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/2x12/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/3x11/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/4x10/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/5x9/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/6x8/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/7x7/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/8x6/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/9x5/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/10x4/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/11x3/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/12x2/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/13x1/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/15/14x/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/x14/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/1x13/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/2x12/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/3x11/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/4x10/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/5x9/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/6x8/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/7x7/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/8x6/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/9x5/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/10x4/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/11x3/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/12x2/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/13x1/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/15/14x/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/x14/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/1x13/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/2x12/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/3x11/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/4x10/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/5x9/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/6x8/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/7x7/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/8x6/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/9x5/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/10x4/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/11x3/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/12x2/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/13x1/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/15/14x/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/x14/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/1x13/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/2x12/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/3x11/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/4x10/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/5x9/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/6x8/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/7x7/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/8x6/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/9x5/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/10x4/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/11x3/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/12x2/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/13x1/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "15/14x/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "x14/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "1x13/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "2x12/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "3x11/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "4x10/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "5x9/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "6x8/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "7x7/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "8x6/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "9x5/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "10x4/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "11x3/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "12x2/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "13x1/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
        "14x/15/15/15/15/15/15/15/15/15/15/15/15/15/15 o 1",
    ];

    for fen in fens {
        let mut pos = GomokuPosition::from_fen(fen);
        std::hint::black_box(pos.perft(2));
    }
}

#[cfg(test)]
mod gomoku {
    use super::*;
    use test::Bencher;

    #[bench]
    fn perft(b: &mut Bencher) {
        b.iter(|| run_perft());
    }
}
